{"version":3,"file":"applets-request-mode-list.es.js","sources":["../node_modules/applets-request-weapp/src/helpers/utils.ts","../node_modules/applets-request-weapp/src/adapter/config.ts","../node_modules/applets-request-weapp/src/adapter/request.ts","../node_modules/applets-request-weapp/src/appletsRequestWeapp.ts","../src/helpers/utils.ts","../src/ApiHttp.ts"],"sourcesContent":["function getDataType(val: any): string {\n  return Object.prototype.toString.call(val);\n}\n\nexport function isPlainObject(val: any): val is Record<string, any> {\n  if (val === null || getDataType(val) !== \"[object Object]\") {\n    return false;\n  }\n  const prototype = Object.getPrototypeOf(val);\n  return prototype === null || prototype === Object.prototype;\n}\n\nexport function assign<T, U>(to: T, from: U): T & U {\n  if (isString(from)) {\n    return to as T & U;\n  }\n\n  for (const key in from) {\n    (to as T & U)[key] = from[key] as any;\n  }\n\n  return to as T & U;\n}\n\nexport function isUndefined(val: any): boolean {\n  return typeof val === \"undefined\";\n}\n\nexport function merge(\n  ...objs: Record<string, any>[]\n): any[] | Record<string, any> {\n  if (objs.length === 0) {\n    return Object.create(null);\n  }\n\n  let result: any = Object.create(null);\n  function assignValue(val: any, key: string | number): void {\n    if (isPlainObject(result[key]) && isPlainObject(val)) {\n      result[key] = merge(result[key], val);\n    } else if (isPlainObject(val)) {\n      result[key] = merge({}, val);\n    } else if (Array.isArray(val)) {\n      result[key] = merge(val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  if (Array.isArray(objs[0])) {\n    result = [];\n  } else {\n    result = Object.create(null);\n  }\n\n  objs.forEach((obj) => {\n    forEach(obj, assignValue);\n  });\n\n  return result;\n}\n\nexport function isString(val: any): boolean {\n  return typeof val === \"string\";\n}\n\n/**\n * 遍历\n * @param {Object|Array} obj\n * @param fn\n */\nexport function forEach(obj: any, fn: IAppletsRequest.IEmptyFN): void {\n  if (typeof obj === \"undefined\" || obj === null) {\n    return;\n  }\n\n  let arr = obj;\n\n  // 如果obj是非object类型，例如：number，string等\n  if (typeof obj !== \"object\") {\n    arr = [obj];\n  }\n\n  if (Array.isArray(arr)) {\n    arr.forEach((item, i) => {\n      fn.call(null, item, i, obj);\n    });\n    return;\n  }\n  Object.keys(arr).forEach((key) => {\n    fn.call(null, arr[key], key, arr);\n  });\n}\n","export default function getRequestOptions(\n  config: IAppletsRequest.IHttpConfig\n): IAppletsRequestWx.RequestOption {\n  const reqConfig: IAppletsRequestWx.RequestOption = {\n    url: config.url || \"\",\n    method: config.method,\n    data: config.data,\n    header: config.headers,\n    dataType: \"json\",\n    timeout: config.timeout,\n  } as IAppletsRequestWx.RequestOption;\n\n  const dataType = config.dataType || \"json\";\n  reqConfig.dataType = dataType;\n\n  if (config.responseType && config.responseType !== \"json\") {\n    reqConfig.dataType = \"其他\";\n  }\n\n  return reqConfig;\n}\n","/*\n * @Author: youzhao.zhou\n * @Date: 2021-02-04 16:09:10\n * @Last Modified by: youzhao.zhou\n * @Last Modified time: 2021-02-22 17:16:17\n * @Description request adapter\n *\n * 1. 执行成功需要返回IAppletsRequestResponse，执行失败即为reject返回IAppletsRequestAdapterError\n * 2. 如果取消返回IAppletsRequest.ICanceler\n */\n\nimport { isUndefined, merge } from \"../helpers/utils\";\nimport getRequestOptions from \"./config\";\n\ninterface IResolveOptions {\n  headers: Record<string, any>;\n  status: number;\n  data: any;\n  response?: any;\n}\n\nexport default function request(\n  config: IAppletsRequest.IHttpConfig\n): IAppletsRequestPromise {\n  function requestSuccess(res: any): IResolveOptions {\n    if (isUndefined(res) || res === null) {\n      return {\n        headers: {},\n        status: 200,\n        data: {},\n        response: res,\n      };\n    }\n\n    return {\n      headers: res.header,\n      status: res.statusCode,\n      data: dataParser(res.data),\n      response: res,\n    };\n  }\n\n  /**\n   * 获取错误类型\n   * @param err\n   * @param timeout\n   * @returns NETWORK_ERROR | TIMEOUT\n   * @example {\n   *    msg: `Timeout of 2000 ms exceeded`,\n   *    type: \"TIMEOUT\",\n   *  }\n   */\n  function failType(\n    err: any,\n    timeout: number | undefined\n  ): { msg: string; type: \"NETWORK_ERROR\" | \"TIMEOUT\" } {\n    if (\n      err &&\n      (err.errMsg || \"\").toString().toLowerCase().includes(\"timeout\")\n    ) {\n      return {\n        msg: `Timeout of ${timeout || \"\"} ms exceeded`,\n        type: \"TIMEOUT\",\n      };\n    }\n    return {\n      msg: `Network Error`,\n      type: \"NETWORK_ERROR\",\n    };\n  }\n\n  /**\n   * JSON parse data\n   * @param data\n   */\n  function dataParser(data: any): any {\n    if (typeof data !== \"string\") {\n      return data;\n    }\n    try {\n      return JSON.parse(data);\n    } catch (e) {\n      return data;\n    }\n  }\n\n  function getReqConfig(\n    originalConfig: IAppletsRequest.IHttpConfig\n  ): IAppletsRequest.IHttpConfig {\n    const tmpConfig: any = merge({}, originalConfig);\n    tmpConfig.headers = originalConfig.header;\n    delete tmpConfig.header;\n    delete tmpConfig.Adapter;\n    return tmpConfig;\n  }\n\n  return new Promise((resolve, reject) => {\n    const Adapter = config.Adapter;\n    const reqConfig = getRequestOptions(config);\n    const adapterConfig = getReqConfig(config);\n\n    if (!Adapter) {\n      throw new TypeError(\"Adapter is undefined or null\");\n    }\n\n    const adapter = new Adapter(adapterConfig);\n\n    let requestor = wx.request({\n      ...reqConfig,\n      success(res: any) {\n        adapter.resolve(requestSuccess(res), resolve);\n      },\n      fail(err: any) {\n        const errData = failType(err, reqConfig.timeout);\n        const rejectData = {\n          errMsg: errData.msg,\n          status: errData.type,\n          extra: err,\n        };\n\n        adapter.reject(rejectData, reject);\n      },\n      complete() {\n        requestor = null;\n      },\n    });\n\n    adapter.subscribeCancelEvent((reason) => {\n      reject(reason);\n      requestor.abort();\n      requestor = null;\n    });\n\n    if (typeof config.getRequestTask === \"function\") {\n      config.getRequestTask(request);\n    }\n  });\n}\n","import appletsRequest, {\n  AppletsRequest,\n  createAppletsRequestInstance,\n  getDefaults as getAppletsRequestDefaults,\n} from \"applets-request\";\nimport weappAdapter from \"./adapter/request\";\n\nappletsRequest.defaults.adapter = weappAdapter;\n\nexport default appletsRequest;\n\nexport { AppletsRequest as AppletsRequest };\n\nexport { createAppletsRequestInstance as createAppletsRequestInstance };\n\nexport function getDefaults(): IAppletsRequestConfig {\n  const defaults = getAppletsRequestDefaults();\n  defaults.adapter = weappAdapter;\n\n  return defaults;\n}\n","/* eslint-disable guard-for-in */\n/* eslint-disable no-restricted-syntax */\nfunction getDataType(val: any): string {\n  return Object.prototype.toString.call(val);\n}\n\nexport function isArray(data: any): boolean {\n  return Array.isArray(data);\n}\n\nexport function isPlainObject(val: any): val is Record<string, any> {\n  if (val === null || getDataType(val) !== \"[object Object]\") {\n    return false;\n  }\n  const prototype = Object.getPrototypeOf(val);\n  return prototype === null || prototype === Object.prototype;\n}\n\nexport function assign<T, U>(to: T, from: U): T & U {\n  if (isString(from)) {\n    return to as T & U;\n  }\n\n  for (const key in from) {\n    (to as T & U)[key] = from[key] as any;\n  }\n\n  return to as T & U;\n}\n\nexport function isString(val: any): boolean {\n  return typeof val === \"string\";\n}\n\n/**\n * 遍历\n * @param {Object|Array} obj\n * @param fn\n */\nexport function forEach(obj: any, fn: IAppletsRequest.IEmptyFN): void {\n  if (typeof obj === \"undefined\" || obj === null) {\n    return;\n  }\n\n  let arr = obj;\n\n  // 如果obj是非object类型，例如：number，string等\n  if (typeof obj !== \"object\") {\n    arr = [obj];\n  }\n\n  if (Array.isArray(arr)) {\n    arr.forEach((item, i) => {\n      fn.call(null, item, i, obj);\n    });\n    return;\n  }\n  Object.keys(arr).forEach((key) => {\n    fn.call(null, arr[key], key, arr);\n  });\n}\n\nexport function merge(\n  ...objs: Record<string, any>[]\n): any[] | Record<string, any> {\n  if (objs.length === 0) {\n    return Object.create(null);\n  }\n\n  let result: any = Object.create(null);\n  function assignValue(val: any, key: string | number): void {\n    if (isPlainObject(result[key]) && isPlainObject(val)) {\n      result[key] = merge(result[key], val);\n    } else if (isPlainObject(val)) {\n      result[key] = merge({}, val);\n    } else if (Array.isArray(val)) {\n      result[key] = merge(val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  if (Array.isArray(objs[0])) {\n    result = [];\n  } else {\n    result = Object.create(null);\n  }\n\n  objs.forEach((obj) => {\n    forEach(obj, assignValue);\n  });\n\n  return result;\n}\n","import appletsRequest, { getDefaults } from \"applets-request-weapp\";\nimport { assign, isArray, isPlainObject, merge } from \"./helpers/utils\";\n\ninterface IApiItemConfig {\n  baseURL: string;\n  url: string;\n  fnName: string;\n  retryTimes?: number;\n  interval?: number;\n}\n\nclass ApiItem<IData = any> {\n  private hadRetry = 0;\n\n  retryTimes = 2;\n\n  interval = 2000;\n\n  baseURL = \"\";\n\n  url = \"\";\n\n  fnName = \"\";\n\n  appletsRequest: AppletsRequestInstance;\n\n  constructor(config: IApiItemConfig, request: AppletsRequestInstance) {\n    const { retryTimes, interval } = config;\n    this.baseURL = config.baseURL;\n    this.url = config.url;\n    this.fnName = config.fnName;\n    this.retryTimes = this.getValidNumber(this.retryTimes, retryTimes);\n    this.interval = this.getValidNumber(this.interval, interval);\n    this.appletsRequest = request;\n  }\n\n  getValidNumber(originalVal: number, val: number | undefined): number {\n    return !val && val !== 0 ? originalVal : val;\n  }\n\n  http(options?: IAppletsRequestConfig): IAppletsRequestPromise<IData> {\n    return new Promise((resolve, reject) => {\n      this.request(options || {}, resolve, reject);\n    });\n  }\n\n  request(\n    options: IAppletsRequestConfig,\n    resolve: any,\n    reject: IAppletsRequest.IRejected\n  ): void {\n    Promise.resolve(options)\n      .then((reqConfig) => this.appletsRequest<IData>(reqConfig))\n      .then((res) => {\n        this.hadRetry = 0;\n        resolve(res);\n      })\n      .catch((err) => {\n        if (this.isRetryError(err) && this.hadRetry < this.retryTimes) {\n          this.hadRetry += 1;\n          const opts = merge(options, err.options || {});\n          this.request(opts, resolve, reject);\n          return;\n        }\n        if (this.isIntervalRetryError(err) && this.hadRetry < this.retryTimes) {\n          setTimeout(() => {\n            this.hadRetry += 1;\n            this.request(options, resolve, reject);\n          }, this.interval);\n          return;\n        }\n        reject(this.isRetryError(err) ? err.originalErr : err);\n      });\n  }\n\n  isRetryError(err: any): boolean {\n    if (!err) {\n      return false;\n    }\n    return err.errCode === \"RETRY_ERROR\";\n  }\n\n  isIntervalRetryError(err: any): boolean {\n    if (!err) {\n      return false;\n    }\n    return err.status === \"NETWORK_ERROR\" || err.status === \"TIMEOUT\";\n  }\n}\n\ninterface IApiHttpConfig {\n  appKey: string;\n\n  appCode: string;\n\n  baseURL: string;\n\n  apiList: { [key: string]: IApiItem } | IApiItem[];\n}\n\nexport default class ApiHttp {\n  appKey: string;\n\n  appCode: string;\n\n  baseURL: string;\n\n  apiList: { [key: string]: IApiItem };\n\n  apis: any;\n\n  appletsRequest: AppletsRequestInstance;\n\n  constructor(config: IApiHttpConfig, requestConfig?: IAppletsRequestConfig) {\n    this.apiList = {};\n    this.apis = Object.create(null);\n    this.appKey = config.appKey;\n    this.appCode = config.appCode;\n    this.baseURL = config.baseURL;\n    this.appletsRequest = appletsRequest.create(requestConfig || getDefaults());\n    this.createApiItem(config.apiList);\n  }\n\n  createApiItem(apiList: { [key: string]: IApiItem } | IApiItem[]): void {\n    if (isArray(apiList)) {\n      const tmpApiList: { [key: string]: IApiItem } = Object.create(null);\n      (apiList as IApiItem[]).forEach((item) => {\n        if (item.fnName) {\n          tmpApiList[item.fnName] = item;\n        }\n      });\n      const fnNames = (apiList as IApiItem[]).map((item) => item.fnName);\n\n      this.apiList = tmpApiList;\n      this.generateApiFn(fnNames as string[]);\n      return;\n    }\n\n    if (isPlainObject(this.apiList)) {\n      const fnNames = Object.keys(this.apiList);\n\n      this.generateApiFn(fnNames);\n    }\n  }\n\n  generateApiFn(fnNames: string[]): void {\n    fnNames.forEach((fnName) => {\n      const apiConfig = this.apiList[fnName] as IApiItem;\n      const apiItem = new ApiItem(\n        {\n          baseURL: this.baseURL,\n          fnName,\n          url: apiConfig.apiUrl,\n          interval: apiConfig.interval,\n          retryTimes: apiConfig.retryTimes,\n        },\n        this.appletsRequest\n      );\n      this.apis[fnName] = apiItem.http.bind(apiItem);\n      this.apis[fnName] = assign(this.apis[fnName], apiItem);\n    });\n  }\n\n  createRetryError(\n    originalErr: any,\n    options?: IAppletsRequestConfig\n  ): {\n    errCode: string;\n    originalErr: any;\n    options: IAppletsRequestConfig | undefined;\n  } {\n    return {\n      errCode: \"RETRY_ERROR\",\n      originalErr,\n      options,\n    };\n  }\n\n  addRequestInterceptor(\n    fulfilled: IAppletsRequest.IResolved<IAppletsRequestConfig>,\n    rejected?: IAppletsRequest.IRejected\n  ): void {\n    this.appletsRequest.interceptors.request.use(fulfilled, rejected);\n  }\n\n  addResponseInterceptor<T>(\n    fulfilled: IAppletsRequest.IResolved<IAppletsRequestResponse<T>>,\n    rejected?: IAppletsRequest.IRejected\n  ): void {\n    this.appletsRequest.interceptors.response.use(fulfilled, rejected);\n  }\n\n  createCancelToken(): IAppletsRequest.ICancelTokenInstance {\n    return new this.appletsRequest.CancelToken();\n  }\n\n  transformConfig(executor: IAppletsRequest.IConfigTransformer): void {\n    this.appletsRequest.defaults.transformConfig = executor;\n  }\n}\n"],"names":["weappAdapter","getAppletsRequestDefaults","getDataType","isPlainObject","forEach","merge"],"mappings":"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"}